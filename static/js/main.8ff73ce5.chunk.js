(this["webpackJsonpobniz-powerpack"]=this["webpackJsonpobniz-powerpack"]||[]).push([[0],{55:function(e,t,n){"use strict";n.r(t);var c=n(8),o=n(0),s=n.n(o),a=n(16),i=n.n(a),u=n(72),r=n(71),l=n(15),d=n(69),h=n(70),f=n(75),p=n(76),b="deviceId",j=function(e){var t=e.onSubmit,n=s.a.useState(localStorage.getItem(b)),o=Object(l.a)(n,2),a=o[0],i=o[1],u=function(){a&&t(a)};return Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),u()},children:[Object(c.jsx)(f.a,{value:a||"",onChange:function(e){return i(e.target.value)}}),Object(c.jsx)(p.a,{type:"submit",children:"Connect"})]})},v=n(74),m=n(77),O=function(e){var t=e.deviceId,n=e.onChange,o=s.a.useState(0),a=Object(l.a)(o,2),i=a[0],u=a[1];return t?Object(c.jsx)(v.a,{children:Object(c.jsx)(m.a,{value:i,max:1e3,onChangeCommitted:function(){return n(i)},onChange:function(e,t){return u(t)}})}):null},k=n(37),w=n(38),y=function(){function e(t){Object(k.a)(this,e),this.deviceId=void 0,this.onOpen=void 0,this.socket=null,this.freq=20,this.pulse=0,this.deviceId=t}return Object(w.a)(e,[{key:"connect",value:function(){var e=this;this.socket=new WebSocket("wss://obniz.com/".concat(this.path)),this.socket.onmessage=function(t){var n,c=JSON.parse(t.data)[0].ws.redirect;console.info(c),null===(n=e.socket)||void 0===n||n.close(),e.socket=new WebSocket("".concat(c,"/").concat(e.path)),e.socket.onopen=function(){e.onOpen&&e.onOpen(),e.setPwm()},window.onunload=function(){var t;null===(t=e.socket)||void 0===t||t.close()}}}},{key:"send",value:function(){if(this.socket){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.socket.send(JSON.stringify(t))}}},{key:"setPwm",value:function(){this.send({pwm0:{io:0,freq:this.freq}}),this.updateDisplay()}},{key:"updateDisplay",value:function(){this.send({display:{clear:!0,text:"Freq: ".concat(this.freq,"\nPluse: ").concat(this.pulse)}})}},{key:"setPulse",value:function(e){this.pulse=e,this.send({pwm0:{pulse:e}}),this.updateDisplay()}},{key:"setFreq",value:function(e){this.freq=e,this.send({pwm0:{freq:e}}),this.updateDisplay()}},{key:"path",get:function(){return"obniz/".concat(this.deviceId,"/ws/1")}}]),e}(),S=function(){var e=s.a.useState(""),t=Object(l.a)(e,2),n=t[0],o=t[1],a=s.a.useState(null),i=Object(l.a)(a,2),u=i[0],r=i[1],f=s.a.useState(!1),p=Object(l.a)(f,2),v=p[0],m=p[1];return Object(c.jsx)(d.a,{maxWidth:"sm",children:n?v?Object(c.jsx)(O,{deviceId:n,onChange:function(e){return null===u||void 0===u?void 0:u.setPulse(e)}}):Object(c.jsx)(h.a,{}):Object(c.jsx)(j,{onSubmit:function(e){o(e),function(e){e?localStorage.setItem(b,e):localStorage.removeItem(b)}(e);var t=new y(e);t.onOpen=function(){m(!0)},t.connect(),r(t)}})})},g=n(39),x=n.n(g),q=n(40),I=Object(q.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:x.a.A400},background:{default:"#fff"}}});i.a.render(Object(c.jsxs)(r.a,{theme:I,children:[Object(c.jsx)(u.a,{}),Object(c.jsx)(S,{})]}),document.querySelector("#root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.8ff73ce5.chunk.js.map